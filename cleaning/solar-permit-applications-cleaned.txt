let
//join the tables
    //joining the data with the contractor_key table allows for all contractor names from the dataset to be standardized from a single list
    //some companies used different phone numbers and addresses, which made it hard to automate the process of standardizing the names when two different spellings were used
        //example: Freedom Solar and Freedom Solar Power are the same company, but their addresses and phone numbers do not match in the data
    //this made it difficult to automate the cleaning of the contractor names, so a manually created list made the most sense in this situation  
    join = Table.Join(cleaning, "contractors_clean", contractor_key, "contractors_clean"),
    //joins the solar-permit-application table and the contractor key table using the cleaned contractor names as the key
    drop_columns = Table.RemoveColumns(join, {"originalzip","housingunits","gispoint","contractorcompanyname","contractoraddress1","contractoraddress2","contractorzip","ownername","owneraddress1","owneraddress2","ownerzip","contractors_clean"}),
    //removes all unneeded columns that are redundant after cleaning
    rename_columns = Table.RenameColumns(drop_columns, {{"originalzip_clean", "originalzip"}, {"contractorzip_clean", "contractorzip"}, {"ownerzip_clean", "ownerzip"}, {"contractoraddress1_clean", "contractoraddress1"}, {"contractoraddress2_clean", "contractoraddress2"}, {"ownername_clean", "ownername"}, {"owneraddress1_clean", "owneraddress1"}, {"owneraddress2_clean", "owneraddress2"}, {"contractors_fixed", "contractorcompanyname"}}),
    //renames cleaned columns to the original names before cleaning
    reorder_columns = Table.ReorderColumns(rename_columns, {"permitnum", "description", "issuedate", "applieddate", "coissueddate", "statuscurrent", "originaladdress1", "originaladdress2", "originalcity", "originalstate", "originalzip", "jurisdiction", "permitclass", "permitclassmapped", "statuscurrentmapped", "workclass", "workclassmapped", "permittype", "permittypemapped", "permittypedesc", "statusdate", "totalsqft", "latitude", "longitude", "projectcost", "pin", "contractorcompanyname", "contractortrade", "contractortrademapped", "contractorphone", "contractoraddress1", "contractoraddress2", "contractorzip", "ownername", "owneraddress1", "owneraddress2", "ownerzip", "year", "year_text"})
    //reorders table so it follows the same structure before cleaing
in
    reorder_columns